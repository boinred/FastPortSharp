# FastPortSharp Latency 성능 테스트 보고서

**보고서 생성일:** 2026-01-21  
**테스트 환경:** Windows, .NET 10, localhost (127.0.0.1:6628)  
**프로토콜:** TCP Echo Request/Response (Protobuf)

---

## 📊 요약

이 보고서는 FastPortSharp 네트워크 라이브러리의 Latency 성능 테스트 결과를 요약합니다.

| 지표 | 값 |
|------|-----|
| **총 테스트 세션** | 6회 |
| **총 수집 샘플** | 2,934개 |
| **평균 RTT** | 79.36 ms |
| **최소 RTT** | 2.72 ms |
| **최대 RTT** | 434.40 ms |

### RTT란?

> RTT(Round-Trip Time)는 클라이언트가 서버에 요청을 보내고 응답을 받을 때까지 걸리는 총 시간을 의미합니다. 이 값은 네트워크 지연 시간과 서버 처리 시간을 모두 포함합니다.

---

## 📈 세션별 테스트 요약


| 세션 | 측정 시간 | 샘플 수 | RTT 평균 | RTT P50 | RTT P95 | RTT P99 |
|------|----------|---------|----------|---------|---------|---------|
| 세션 1 | 00:00:02 | 14 | 129.68 ms | 124.76 ms | 221.64 ms | 230.25 ms |
| 세션 2 | 00:00:14 | 58 | 156.69 ms | 151.52 ms | 349.41 ms | 415.14 ms |
| 세션 3 | 00:05:00 | 1,941 | 100.91 ms | 93.82 ms | 187.40 ms | 248.93 ms |
| 세션 4 | 00:01:00 | 839 | 65.03 ms | 59.69 ms | 137.83 ms | 195.50 ms |
| 세션 5 | 00:00:13 | 38 | 62.68 ms | 60.61 ms | 79.67 ms | 110.11 ms |
| 세션 6 | 00:00:05 | 44 | 61.20 ms | 60.50 ms | 91.50 ms | 107.20 ms |

---

## 🔍 상세 지표

### RTT (왕복 시간) 통계

| 지표 | 세션 1 | 세션 2 | 세션 3 | 세션 4 | 세션 5 | 세션 6 | **평균** |
|------|--------|--------|--------|--------|--------|--------|----------|
| 최소 | 31.87 ms | 28.06 ms | 2.72 ms | 8.67 ms | 43.35 ms | 33.25 ms | **24.65 ms** |
| 최대 | 232.40 ms | 434.40 ms | 375.79 ms | 251.73 ms | 122.65 ms | 107.70 ms | **254.11 ms** |
| 평균 | 129.68 ms | 156.69 ms | 100.91 ms | 65.03 ms | 62.68 ms | 61.20 ms | **96.03 ms** |
| P50 | 124.76 ms | 151.52 ms | 93.82 ms | 59.69 ms | 60.61 ms | 60.50 ms | **91.82 ms** |
| P95 | 221.64 ms | 349.41 ms | 187.40 ms | 137.83 ms | 79.67 ms | 91.50 ms | **177.91 ms** |
| P99 | 230.25 ms | 415.14 ms | 248.93 ms | 195.50 ms | 110.11 ms | 107.20 ms | **217.86 ms** |

### 서버 처리 시간 통계

| 지표 | 세션 1 | 세션 2 | 세션 3 | 세션 4 | 세션 5 | 세션 6 | **평균** |
|------|--------|--------|--------|--------|--------|--------|----------|
| 최소 | 0.011 ms | 0.007 ms | 0.005 ms | 0.004 ms | 0.007 ms | 0.004 ms | **0.006 ms** |
| 최대 | 3.521 ms | 2.642 ms | 5.014 ms | 4.651 ms | 3.868 ms | 0.016 ms | **3.285 ms** |
| 평균 | 1.186 ms | 0.067 ms | 0.015 ms | 0.013 ms | 0.115 ms | 0.008 ms | **0.234 ms** |

### 네트워크 지연 시간 (추정) 통계

| 지표 | 세션 1 | 세션 2 | 세션 3 | 세션 4 | 세션 5 | 세션 6 | **평균** |
|------|--------|--------|--------|--------|--------|--------|----------|
| 최소 | 31.85 ms | 28.01 ms | 2.72 ms | 8.67 ms | 43.35 ms | 33.25 ms | **24.64 ms** |
| 최대 | 228.88 ms | 434.39 ms | 375.78 ms | 251.72 ms | 122.63 ms | 107.69 ms | **253.52 ms** |
| 평균 | 128.49 ms | 156.62 ms | 100.90 ms | 65.01 ms | 62.56 ms | 61.19 ms | **95.80 ms** |

---

## 📊 성능 분석

### 주요 발견 사항

1. **서버 처리 시간 우수**
   - 평균: **0.234 ms** (1밀리초 미만)
   - 서버 측 패킷 처리가 매우 효율적임
   - Protobuf 직렬화/역직렬화 오버헤드가 최소화됨

2. **네트워크 지연이 RTT의 대부분 차지**
   - 네트워크 지연이 전체 RTT의 **~99.8%** 차지
   - 서버 처리는 **~0.2%**만 차지
   - 애플리케이션이 CPU 바운드가 아닌 I/O 바운드임을 확인

3. **지연 시간 편차**
   - P99 지연 시간이 평균 RTT의 약 **2.4배**
   - 간헐적인 네트워크 혼잡 또는 GC 일시 정지 가능성

4. **처리량 추정**
   - 평균 RTT ~65ms 기준, 연결당 이론적 최대 ~15 요청/초
   - 실제 처리량: ~14 요청/초 (세션 4: 60초에 839 샘플)

### 성능 구성 비율

```
┌─────────────────────────────────────────────────────────────┐
│                  RTT 구성 비율 (평균)                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ████████████████████████████████████████████████░ 99.8%    │
│  네트워크 지연: 95.80 ms                                     │
│                                                             │
│  ░ 0.2%                                                     │
│  서버 처리: 0.234 ms                                         │
│                                                             │
│  총 RTT: ~96 ms                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 개선 권장 사항

### 단기 최적화

1. **연결 풀링**: 병렬 요청을 위해 다중 연결 사용
2. **배치 처리**: 여러 작은 패킷을 큰 배치로 결합
3. **Keep-Alive 튜닝**: TCP Keep-Alive 설정 최적화

### 장기 개선

1. **UDP 지원**: 지연 시간이 중요하고 손실 허용 가능한 시나리오용
2. **QUIC 프로토콜**: 더 나은 성능을 위해 QUIC로 마이그레이션 고려
3. **Zero-Copy 버퍼**: 메모리 할당 추가 최적화

---

## 📋 테스트 구성

```json
{
  "LatencyStats": {
    "EnableConsoleOutput": true,
    "EnableFileOutput": true,
    "OutputDirectory": "Stats",
    "OutputFilePrefix": "latency_stats",
    "FileWriteIntervalSeconds": 60,
    "MaxSamplesInMemory": 10000
  }
}
```

### 환경 상세

| 구성 요소 | 버전/설정 |
|----------|----------|
| .NET 런타임 | .NET 10 |
| 운영체제 | Windows |
| 전송 프로토콜 | TCP |
| 직렬화 | Protobuf 3.32.1 |
| 버퍼 구현 | ArrayPoolCircularBuffers |
| 테스트 유형 | Echo Request/Response |

---

## 📈 결론

FastPortSharp는 1밀리초 미만의 응답 시간으로 우수한 서버 측 처리 성능을 보여줍니다. 주요 지연 요인은 네트워크 I/O이며, 이는 localhost TCP Echo 테스트에서 예상되는 결과입니다.

**전체 평가: ✅ 통과**

| 항목 | 평가 | 설명 |
|------|------|------|
| 서버 처리 시간 | **우수** | 평균 1ms 미만 |
| 메모리 효율성 | **양호** | ArrayPool 기반 버퍼 사용 |
| 안정성 | **양호** | 일관된 P50/P95 비율 |

---

*FastPortSharp Latency Statistics System에서 생성된 보고서*
